footer: Â© NodeProgram.com, Node.University and Azat Mardan 2017
slidenumbers: true

# Node in Production
## Module 2: Node Production Preparations

![inline 100%](images/azat.jpeg)
Azat Mardan @azat_co

![inline right](images/nu.png)

---

## Securing your app with environmental variables

---

## Why not store in code?

* Accidentally publishing sensitive information [^1]
* GitHub/Bitbuckes/GitLab might and *were* hacked [^2]
* Code is less flexible to change in a cloud environment

[^1]: For example, [In major goof, Uber stored sensitive database key on public GitHub page](https://arstechnica.com/security/2015/03/in-major-goof-uber-stored-sensitive-database-key-on-public-github-page)

[^2]: For example, [GitHub Security Update: Reused password attack](https://github.com/blog/2190-github-security-update-reused-password-attack)

---

Bad practice:

```js
const apiKey = ''
const apiSecret = ''
const databaseUrl = ''

const dbConnection = db.connect(databaseUrl) // connect to a database
oauth.get(apiKey, apiSecret, accessCode, callback) // fetch protected resource using OAuth
```

---

Having config .json files (or .js) is still not good since most likely they are stored together with the code

Bad practice:

* config.json
* api/server/databasources.json (Loopback)

---

## Use Env Vars

One-liner:

```bash
MY_ENV_VAR=hello node -e "console.log(`I see: ${process.env.MY_ENV_VAR}`)"
```

In session:

```bash
export MY_ENV_VAR=hello
node -e "console.log(`I see: ${process.env.MY_ENV_VAR}`)"
```

---


```js
const apiKey = process.env.API_KEY
const apiSecret = process.env.API_SECRET
const databaseUrl = process.env.DATABASE_URL

const dbConnection = db.connect(databaseUrl) // connect to a database
oauth.get(apiKey, apiSecret, accessCode, callback) // fetch protected resource using OAuth
```


---

* GitHub stores all your history
* GitHub is
---

## Separating development and production dependencies

---

## Locking in dependencies versions

---

## Committing, packing modules or using private registry

---

## Deployment from branches

---

## Consolidated logs

---

## Stateless architecture

---

## Ping endpoint

---

## Process managers

---

## CI/CD: CircleCI, Drone, TravisCI

---

## End of Module 2. Continue with Docker and AWS ðŸ‘‰